import{_ as B,r as v,d as S,e as G,p as j,w as O,o as r,c as g,a as u,F as T,f as z,q as M,t as y,b,g as J,s as Q,l as X,u as Y,v as Z,k as L,x as w,y as N,j as V}from"./index-CopEubkt.js";import{u as A}from"./wishlist-CJt9VGUI.js";import{g as $}from"./URL-C2DF9UWd.js";import{M as ee}from"./MovieInfiniteScroll-D9i972dI.js";const te={name:"MovieGrid",props:{fetchUrl:{type:String,required:!0}},setup(_){const i=v([]),s=v(1),e=v(null),c=v(4),n=v(20),t=v(window.innerWidth<=768);v("grid");let d=null;const{wishlist:o,loadWishlist:k,toggleWishlist:W,isInWishlist:E}=A(),R=async()=>{try{const f=Math.ceil(6);let h=[];for(let l=1;l<=f;l++){const m=await J.get(_.fetchUrl,{params:{page:l,per_page:n}});h=[...h,...m.data.results]}i.value=h.slice(0,120)}catch(a){console.error("Error fetching movies:",a)}},F=a=>`https://image.tmdb.org/t/p/w300${a}`,x=()=>{if(e.value){const a=e.value.offsetWidth,f=window.innerHeight-e.value.offsetTop,h=t.value?90:200,l=t.value?150:220,m=t.value?10:15,P=-10;c.value=Math.floor(a/(h+m));const p=Math.floor(f/(l+P));n.value=c.value*p}},H=S(()=>{const a=(s.value-1)*n.value,f=a+n.value;return i.value.slice(a,f).reduce((l,m,P)=>{const p=Math.floor(P/c.value);return l[p]||(l[p]=[]),l[p].push(m),l},[])}),I=S(()=>Math.ceil(i.value.length/n.value)),q=()=>{s.value<I.value&&s.value++},D=()=>{s.value>1&&s.value--},C=()=>{t.value=window.innerWidth<=768,x()},K=a=>{U(),d=setTimeout(()=>{W(a)},2e3)},U=()=>{d&&(clearTimeout(d),d=null)};return G(()=>{R(),x(),k(),window.addEventListener("resize",C)}),j(()=>{window.removeEventListener("resize",C)}),O([c,n],()=>{s.value=1}),{visibleMovieGroups:H,currentPage:s,totalPages:I,getImageUrl:F,nextPage:q,prevPage:D,gridContainer:e,rowSize:c,startWishlistTimer:K,clearWishlistTimer:U,toggleWishlist:W,isInWishlist:E}}},oe={class:"movie-grid",ref:"gridContainer"},se=["onMouseup"],ae=["src","alt"],ie={class:"movie-title"},ne={key:0,class:"wishlist-indicator"},le={key:0,class:"pagination"},re=["disabled"],ce=["disabled"];function de(_,i,s,e,c,n){return r(),g("div",oe,[u("div",{class:M(["grid-container",_.currentView])},[(r(!0),g(T,null,z(e.visibleMovieGroups,(t,d)=>(r(),g("div",{key:d,class:M(["movie-row",{full:t.length===e.rowSize}])},[(r(!0),g(T,null,z(t,o=>(r(),g("div",{key:o.id,class:"movie-card",onMouseup:k=>e.toggleWishlist(o)},[u("img",{src:e.getImageUrl(o.poster_path),alt:o.title},null,8,ae),u("div",ie,y(o.title),1),e.isInWishlist(o.id)?(r(),g("div",ne,"👍")):b("",!0)],40,se))),128))],2))),128))],2),e.totalPages>1?(r(),g("div",le,[u("button",{onClick:i[0]||(i[0]=(...t)=>e.prevPage&&e.prevPage(...t)),disabled:e.currentPage===1},"< 이전",8,re),u("span",null,y(e.currentPage)+" / "+y(e.totalPages),1),u("button",{onClick:i[1]||(i[1]=(...t)=>e.nextPage&&e.nextPage(...t)),disabled:e.currentPage===e.totalPages},"다음 >",8,ce)])):b("",!0)],512)}const ue=B(te,[["render",de],["__scopeId","data-v-acab3a9b"]]),ve={class:"popular-container"},ge={class:"view-toggle"},he=Q({__name:"home-popular",setup(_){X.add(Y,Z);const i=localStorage.getItem("TMDb-Key")||"",s=$(i),e=v("grid"),c=d=>{e.value=d},n=()=>{document.body.style.overflow="hidden"},t=()=>{document.body.style.overflow="auto"};return G(()=>{n()}),(d,o)=>(r(),g("div",ve,[u("div",ge,[u("button",{onClick:o[0]||(o[0]=()=>{c("grid"),n()}),class:M({active:e.value==="grid"})},[L(w(V),{icon:["fas","th"]})],2),u("button",{onClick:o[1]||(o[1]=()=>{c("list"),t()}),class:M({active:e.value==="list"})},[L(w(V),{icon:["fas","bars"]})],2)]),e.value==="grid"?(r(),N(ue,{key:0,title:"인기 영화",fetchUrl:w(s)},null,8,["fetchUrl"])):b("",!0),e.value==="list"?(r(),N(ee,{key:1,title:"인기 영화",fetchUrl:w(s)},null,8,["fetchUrl"])):b("",!0)]))}}),we=B(he,[["__scopeId","data-v-fca23856"]]);export{we as default};
